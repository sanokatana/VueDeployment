"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[742],{5556:function(e,t,a){a.d(t,{c:function(){return u}});var l=a(7988),o=a(9435),r={root:function(e){var t=e.instance,a=e.props;return["p-inputtextarea p-inputtext p-component",{"p-filled":t.filled,"p-inputtextarea-resizable ":a.autoResize,"p-invalid":a.invalid,"p-variant-filled":a.variant?"filled"===a.variant:"filled"===t.$primevue.config.inputStyle}]}},s=o.c.extend({name:"textarea",classes:r}),n=a(4108),i={name:"BaseTextarea",extends:l.c,props:{modelValue:null,autoResize:Boolean,invalid:{type:Boolean,default:!1},variant:{type:String,default:null}},style:s,provide:function(){return{$parentInstance:this}}},u={name:"Textarea",extends:i,emits:["update:modelValue"],mounted:function(){this.$el.offsetParent&&this.autoResize&&this.resize()},updated:function(){this.$el.offsetParent&&this.autoResize&&this.resize()},methods:{resize:function(){this.$el.style.height="auto",this.$el.style.height=this.$el.scrollHeight+"px",parseFloat(this.$el.style.height)>=parseFloat(this.$el.style.maxHeight)?(this.$el.style.overflowY="scroll",this.$el.style.height=this.$el.style.maxHeight):this.$el.style.overflow="hidden"},onInput:function(e){this.autoResize&&this.resize(),this.$emit("update:modelValue",e.target.value)}},computed:{filled:function(){return null!=this.modelValue&&this.modelValue.toString().length>0},ptmParams:function(){return{context:{disabled:this.$attrs.disabled||""===this.$attrs.disabled}}}}},d=["value"];function c(e,t,a,l,o,r){return(0,n.Wz)(),(0,n.An)("textarea",(0,n.Gu)({class:e.cx("root"),value:e.modelValue,onInput:t[0]||(t[0]=function(){return r.onInput&&r.onInput.apply(r,arguments)})},e.ptm("root",r.ptmParams)),null,16,d)}u.render=c},4742:function(e,t,a){a.r(t),a.d(t,{default:function(){return be}});var l=a(4108);const o={class:"col-12 offset-10"},r=(0,l.QD)("div",{class:"flex justify-content-between align-items-center"},[(0,l.QD)("h1",{class:"text-ggi-red"},"Panel Form - Form Keluhan Pelanggan")],-1),s={class:"flex justify-content-start mb-4"},n={class:"p-input-icon-left"},i=(0,l.QD)("i",{class:"pi pi-search"},null,-1);function u(e,t,a,u,d,c){const m=(0,l.E1)("InputText"),p=(0,l.E1)("Dropdown"),f=(0,l.E1)("Column"),b=(0,l.E1)("StatusTag"),h=(0,l.E1)("DataTable"),y=(0,l.E1)("formModal");return(0,l.Wz)(),(0,l.An)("div",o,[r,(0,l.QD)("div",s,[(0,l.QD)("span",n,[i,(0,l.K2)(m,{modelValue:d.filters["global"].value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.filters["global"].value=e),placeholder:"Keyword Search",class:"w-10rem"},null,8,["modelValue"])]),(0,l.QD)("span",null,[(0,l.K2)(p,{modelValue:d.selectedStatus,"onUpdate:modelValue":t[1]||(t[1]=e=>d.selectedStatus=e),options:d.statusfilter,placeholder:"Select a City",class:"w-full md:w-9rem ml-2"},null,8,["modelValue","options"])])]),(0,l.K2)(h,{ref:"dt",filters:d.filters,value:d.formData,selectionMode:"single",onRowSelect:t[2]||(t[2]=e=>c.showModal("edit",e.data)),responsiveLayout:"scroll",sortField:"id",sortOrder:1,paginator:!0,rows:15,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",rowsPerPageOptions:[15,20,30],removableSort:"",dataKey:"id","onUpdate:filters":t[3]||(t[3]=e=>d.filters=e),filterDisplay:"row"},{default:(0,l.Ql)((()=>[(0,l.K2)(f,{field:"id",header:"Form ID"}),(0,l.K2)(f,{field:"attributes.name",header:"Nama Pemilik / Penghuni"}),(0,l.K2)(f,{field:"attributes.alamat",header:"Alamat"}),(0,l.K2)(f,{field:"attributes.tglKeluhan",header:"Tanggal Keluhan"}),(0,l.K2)(f,{field:"attributes.status",header:"Status"},{body:(0,l.Ql)((e=>[(0,l.K2)(b,{modelValue:e.data.attributes.status,"onUpdate:modelValue":t=>e.data.attributes.status=t},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["filters","value"]),(0,l.K2)(y,{displayModal:d.displayModal,"onUpdate:displayModal":t[4]||(t[4]=e=>d.displayModal=e),form:d.selectedForm,"onUpdate:form":t[5]||(t[5]=e=>d.selectedForm=e),refreshList:c.getAllForms,action:d.action},null,8,["displayModal","form","refreshList","action"])])}var d=a(4432),c=a(5160),m=a(2340),p=a(9140),f=a(6960),b=a(8331),h=a(1147),y=a(9096);const g={class:"p-m-0"},x={class:"text-ggi-red"},v={ref:"form"},w={class:"formgrid grid"},D={class:"field col-12 md:col-12"},C=(0,l.QD)("label",null,[(0,l.QD)("span",null,"Status")],-1),k={class:"field col-12 md:col-6"},V=(0,l.QD)("label",null,[(0,l.QD)("span",null,"Tanggal Keluhan")],-1),Q={class:"field col-12 md:col-6"},T=(0,l.QD)("label",null,[(0,l.QD)("span",null,"Nama Pemilik / Penghuni:")],-1),F={class:"field col-12 md:col-12"},K=(0,l.QD)("label",null,"Alamat Pemilik / Penghuni",-1),P={class:"field col-12 md:col-12"},S=(0,l.QD)("label",null,"Uraian Keluhan",-1),U={class:"field col-12 md:col-12"},M=(0,l.QD)("label",null,"Tindakan Perbaikan",-1),$={class:"field col-12 md:col-12"},I=(0,l.QD)("label",null,"Analisa Penyebab Masalah",-1),z={class:"field col-12 md:col-12"},A=(0,l.QD)("label",null,"Tindakan Pencegahan",-1),B={class:"field col-12 md:col-4"},R=(0,l.QD)("label",null,"Status Masalah",-1),E={class:"field col-12 md:col-4"},L=(0,l.QD)("label",null,"Tanggal: ",-1),O={class:"field col-12 md:col-4"},N=(0,l.QD)("label",null,"Jam : ",-1),H={class:"field col-12 md:col-6"},j=(0,l.QD)("label",null,[(0,l.QD)("span",null,"Tenant Relation :")],-1),W={class:"field col-12 md:col-6"},_=(0,l.QD)("label",null,[(0,l.QD)("span",null,"Diverifikasi Oleh : ")],-1),J={class:"flex justify-content-between flex-wrap"},Y={class:"flex"},G={class:"flex"};function q(e,t,a,o,r,s){const n=(0,l.E1)("Button"),i=(0,l.E1)("Dropdown"),u=(0,l.E1)("Calendar"),d=(0,l.E1)("InputText"),c=(0,l.E1)("Textarea"),m=(0,l.E1)("ConfirmDialog"),p=(0,l.E1)("Dialog");return(0,l.Wz)(),(0,l.Az)(p,{visible:a.displayModal,modal:!0,closable:!1,style:{width:"90vh"}},{header:(0,l.Ql)((()=>[(0,l.QD)("h3",g,[(0,l.QD)("span",x,"Edit Customer Form Customer Complaint Number # "+(0,y.WA)(a.form.id),1)]),(0,l.K2)(n,{label:"Close",icon:"pi pi-times",class:"button-rounded button-text ml-auto button-secondary",onClick:s.handleClose},null,8,["onClick"])])),footer:(0,l.Ql)((()=>[(0,l.QD)("div",J,[(0,l.QD)("div",Y,[(0,l.K2)(n,{label:"Print",icon:"pi pi-print",onClick:t[13]||(t[13]=e=>s.fillForm())})]),(0,l.QD)("div",G,[(0,l.K2)(n,{label:"edit"==a.action?"Save":"Add Document",icon:"edit"==a.action?"pi pi-save":"pi pi-plus",onClick:t[14]||(t[14]=e=>s.handleSubmit(a.action))},null,8,["label","icon"])])]),(0,l.K2)(m)])),default:(0,l.Ql)((()=>[(0,l.QD)("form",v,[(0,l.QD)("div",w,[(0,l.QD)("div",D,[C,(0,l.K2)(i,{modelValue:s.formCopy.attributes.status,"onUpdate:modelValue":t[0]||(t[0]=e=>s.formCopy.attributes.status=e),options:r.statusoptions,class:"text-base text-color surface-overlay surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue","options"])]),(0,l.QD)("div",k,[V,(0,l.K2)(u,{id:"name",modelValue:s.formCopy.attributes.tglKeluhan,"onUpdate:modelValue":t[1]||(t[1]=e=>s.formCopy.attributes.tglKeluhan=e),showButtonBar:"",showIcon:"",dateFormat:"yy-mm-dd",class:"text-base text-color surface-overlay surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue"])]),(0,l.QD)("div",Q,[T,(0,l.K2)(d,{id:"name",modelValue:s.formCopy.attributes.name,"onUpdate:modelValue":t[2]||(t[2]=e=>s.formCopy.attributes.name=e),class:"text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue"])]),(0,l.QD)("div",F,[K,(0,l.K2)(c,{id:"alamat",autoResize:"",rows:"1",modelValue:s.formCopy.attributes.alamat,"onUpdate:modelValue":t[3]||(t[3]=e=>s.formCopy.attributes.alamat=e),class:"text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue"])]),(0,l.QD)("div",P,[S,(0,l.K2)(c,{id:"uraiankeluhan",autoResize:"",rows:"3",modelValue:s.formCopy.attributes.uraiankeluhan,"onUpdate:modelValue":t[4]||(t[4]=e=>s.formCopy.attributes.uraiankeluhan=e),class:"text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue"])]),(0,l.QD)("div",U,[M,(0,l.K2)(c,{id:"tindakanperbaikan",autoResize:"",rows:"3",modelValue:s.formCopy.attributes.tindakanperbaikan,"onUpdate:modelValue":t[5]||(t[5]=e=>s.formCopy.attributes.tindakanperbaikan=e),class:"text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue"])]),(0,l.QD)("div",$,[I,(0,l.K2)(c,{id:"analisamasalah",autoResize:"",rows:"3",modelValue:s.formCopy.attributes.analisamasalah,"onUpdate:modelValue":t[6]||(t[6]=e=>s.formCopy.attributes.analisamasalah=e),class:"text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue"])]),(0,l.QD)("div",z,[A,(0,l.K2)(c,{id:"tindakanpencegahan",autoResize:"",rows:"3",modelValue:s.formCopy.attributes.tindakanpencegahan,"onUpdate:modelValue":t[7]||(t[7]=e=>s.formCopy.attributes.tindakanpencegahan=e),class:"text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue"]),(0,l.mY)(" ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ")]),(0,l.QD)("div",B,[R,(0,l.K2)(i,{modelValue:s.formCopy.attributes.masalah,"onUpdate:modelValue":t[8]||(t[8]=e=>s.formCopy.attributes.masalah=e),options:r.masalahOptions,class:"text-base text-color surface-overlay surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue","options"])]),(0,l.QD)("div",E,[L,(0,l.K2)(u,{id:"terbilang",modelValue:s.formCopy.attributes.tglPrint,"onUpdate:modelValue":t[9]||(t[9]=e=>s.formCopy.attributes.tglPrint=e),dateFormat:"yy-mm-dd",showButtonBar:"",showIcon:"",view:"date",class:"text-base text-color surface-overlay surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue"])]),(0,l.QD)("div",O,[N,(0,l.K2)(u,{id:"terbilang",modelValue:s.formCopy.attributes.waktu,"onUpdate:modelValue":t[10]||(t[10]=e=>s.formCopy.attributes.waktu=e),showButtonBar:"",showIcon:"",timeOnly:"",class:"text-base text-color surface-overlay surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue"])]),(0,l.QD)("div",H,[j,(0,l.K2)(d,{id:"name",modelValue:s.formCopy.attributes.tenant,"onUpdate:modelValue":t[11]||(t[11]=e=>s.formCopy.attributes.tenant=e),class:"text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue"])]),(0,l.QD)("div",W,[_,(0,l.K2)(d,{id:"name",modelValue:s.formCopy.attributes.verifikasi,"onUpdate:modelValue":t[12]||(t[12]=e=>s.formCopy.attributes.verifikasi=e),class:"text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full"},null,8,["modelValue"])])])],512)])),_:1},8,["visible"])}a(2168),a(5104),a(8312);var X=a(100),Z=a(3952),ee=a(8830),te=a(5556),ae=a(2332),le=a(3592),oe=a.p+"assets/pdf/FormCCMarchand.pdf";let re=new m.c;var se={components:{Dialog:X.c,Button:ee.c,ConfirmDialog:Z.c,InputText:f.c,Textarea:te.c,Calendar:ae.c,Dropdown:p.c},props:["displayModal","form","refreshList","action"],res:null,data(){return{masalahOptions:["Minor","Major"],statusoptions:["Batal","Aktif"]}},methods:{changeDataFormat(e){const t=e.split("-"),a=t[0],l=t[1],o=t[2];return`${o}-${l}-${a}`},async fillForm(){try{let e;e=await fetch(oe).then((e=>e.arrayBuffer()));const t=await le.PDFDocument.load(e),a=t.getForm();a.getTextField("id").setText(JSON.stringify(this.form.id));const l=this.changeDataFormat(this.form.attributes.tglKeluhan);a.getTextField("tglKeluhan").setText(l),a.getTextField("nama").setText(this.form.attributes.name),a.getTextField("alamat").setText(this.form.attributes.alamat),a.getTextField("uraiankeluhan").setText(this.form.attributes.uraiankeluhan),a.getTextField("tindakanperbaikan").setText(this.form.attributes.tindakanperbaikan),a.getTextField("analisa").setText(this.form.attributes.analisamasalah),a.getTextField("tindakanpencegahan").setText(this.form.attributes.tindakanpencegahan),a.getTextField("masalah").setText(this.form.attributes.masalah);const o=this.changeDataFormat(this.form.attributes.tglPrint);a.getTextField("tglPrint").setText(o),a.getTextField("tenant").setText(this.form.attributes.tenant),a.getTextField("verifikasi").setText(this.form.attributes.verifikasi);const r=this.form.attributes.waktu,[s,n]=r.split(":");a.getTextField("waktu").setText(s+":"+n);const i=await t.save(),u=new Blob([i],{type:"application/pdf"}),d=URL.createObjectURL(u);window.open(d,"_blank"),URL.revokeObjectURL(d)}catch(e){console.error("Error while processing PDF:",e)}},handleClose(){this.$emit("update:form",null),this.$emit("update:displayModal",!1)},async handleSubmit(){try{const e=new Date(this.formCopy.attributes.tglKeluhan);if(e.setHours(e.getHours()+7),this.formCopy.attributes.tglKeluhan=e.toISOString(),isNaN(new Date(this.formCopy.attributes.waktu)))this.formCopy.attributes.waktu;else{let e=new Date(this.formCopy.attributes.waktu),t=e.getHours().toString().padStart(2,"0"),a=e.getMinutes().toString().padStart(2,"0");this.formCopy.attributes.waktu=`${t}:${a}:00`}const t=new Date(this.formCopy.attributes.tglPrint);t.setHours(t.getHours()+7),this.formCopy.attributes.tglPrint=t.toISOString();let a={...this.formCopy.attributes},l=this.formCopy.id,o=null,r={data:a};o=await re.ccMarchand.updateByID(l,r),this.handleClose(),this.refreshList(),console.log(o),this.$toast.add({severity:"success",summary:"Form Update Success",detail:`Form #${o.data.data.id} has been saved`,life:3e3})}catch(e){console.error("Error while saving form:",e)}}},computed:{formCopy(){return{...this.form}}}},ne=a(4100);const ie=(0,ne.c)(se,[["render",q]]);var ue=ie,de=a(884),ce=a.n(de),me=new m.c,pe={components:{DataTable:d.c,Column:c.c,InputText:f.c,formModal:ue,Dropdown:p.c,StatusTag:h.c},data(){return{formData:null,action:null,selectedForm:null,displayModal:!1,statuses:["Batal","Aktif"],statusfilter:["Semua","Batal","Aktif"],selectedStatus:"Semua",filters:{global:{value:null,matchMode:b.yI.CONTAINS},"attributes.status":{value:null,matchMode:b.yI.CONTAINS}}}},created(){this.getAllForms()},watch:{selectedStatus(e){"Semua"!==e?(this.filters["attributes.status"].value=e,this.getAllForms()):(this.filters["attributes.status"].value=null,this.getAllForms())}},methods:{async getAllForms(){try{let e=ce().stringify({}),t=await me.ccMarchand.findAll(e);this.formData=t.data.data}catch(e){console.log(e)}},showModal(e,t){this.action=e,this.selectedForm=t,this.displayModal=!0}}};const fe=(0,ne.c)(pe,[["render",u]]);var be=fe}}]);
//# sourceMappingURL=742.js.map